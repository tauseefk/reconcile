!function(){function e(e){return e&&e.__esModule?e.default:e}var t,n=new Uint8Array(16);function s(){if(!t&&!(t="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto)))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return t(n)}var o=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;function r(e){return"string"==typeof e&&o.test(e)}for(var i,c,a=[],d=0;d<256;++d)a.push((d+256).toString(16).substr(1));var l=0,u=0;function m(e,t,n){var o=t&&n||0,d=t||new Array(16),m=(e=e||{}).node||i,p=void 0!==e.clockseq?e.clockseq:c;if(null==m||null==p){var f=e.random||(e.rng||s)();null==m&&(m=i=[1|f[0],f[1],f[2],f[3],f[4],f[5]]),null==p&&(p=c=16383&(f[6]<<8|f[7]))}var g=void 0!==e.msecs?e.msecs:Date.now(),w=void 0!==e.nsecs?e.nsecs:u+1,v=g-l+(w-u)/1e4;if(v<0&&void 0===e.clockseq&&(p=p+1&16383),(v<0||g>l)&&void 0===e.nsecs&&(w=0),w>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");l=g,u=w,c=p;var b=(1e4*(268435455&(g+=122192928e5))+w)%4294967296;d[o++]=b>>>24&255,d[o++]=b>>>16&255,d[o++]=b>>>8&255,d[o++]=255&b;var x=g/4294967296*1e4&268435455;d[o++]=x>>>8&255,d[o++]=255&x,d[o++]=x>>>24&15|16,d[o++]=x>>>16&255,d[o++]=p>>>8|128,d[o++]=255&p;for(var h=0;h<6;++h)d[o+h]=m[h];return t||function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=(a[e[t+0]]+a[e[t+1]]+a[e[t+2]]+a[e[t+3]]+"-"+a[e[t+4]]+a[e[t+5]]+"-"+a[e[t+6]]+a[e[t+7]]+"-"+a[e[t+8]]+a[e[t+9]]+"-"+a[e[t+10]]+a[e[t+11]]+a[e[t+12]]+a[e[t+13]]+a[e[t+14]]+a[e[t+15]]).toLowerCase();if(!r(n))throw TypeError("Stringified UUID is invalid");return n}(d)}var p={};Object.defineProperty(p,"__esModule",{value:!0});class f{constructor(e,t){this.subscribe=e,this.unsubscribe=t}compose(e){return e(this)}map(e){return this.compose(function(e){return t=>new f((n=>{t.subscribe({next:t=>n.next(e(t)),complete:n.complete})}))}(e))}filter(e){return this.compose(function(e){return t=>new f((n=>{t.subscribe({next:t=>e(t)?n.next(t):void 0,complete:n.complete})}))}(e))}debounceTime(e){return this.compose(function(e){let t=null;return n=>new f((s=>{n.subscribe({next:n=>{t&&(clearTimeout(t),t=null),t=window.setTimeout((()=>s.next(n)),e)},complete:()=>{t&&window.clearTimeout(t),s.complete()}})}))}(e))}static fromEvent(e,t){const n=new f((s=>{t.addEventListener(e,s.next),n.unsubscribe=()=>t.removeEventListener(e,s.next)}));return n}}var g=f;p.default=g;var w=e(p);const v=()=>new Promise(requestAnimationFrame),b=e=>t=>new Promise((n=>{window.setTimeout((()=>n(t)),e)})),x=()=>{},h="disconnect",y="info",E="newMessage",L="userTyping",I="userStoppedTyping",C="userConnected",T="userDisconnected",M="messageId",k="emphasizeMessage",B=window.location.port?":"+window.location.port:"",j=`${window.location.hostname}${B}`,V=io.connect(j);let D=null,R=null,S=null,U=null,q=null,_=null;const A=new Map,P=($="Enter",e=>e===$);var $;b(1e3);const O=b(2e3),z=b(250);V.on(y,(({id:e,connectedUsers:t})=>{U=e,t.filter((e=>e!==U)).forEach((e=>{ee({userId:e})}))}));const F=new w((e=>{V.on(C,e.next),V.on(C,e.complete)})),G=new w((e=>{V.on(T,e.next),V.on(T,e.complete)})),H=new w((e=>{V.on(E,e.next),V.on(h,e.complete)})),J=new w((e=>{V.on(L,e.next),V.on(L,e.complete)})),K=new w((e=>{V.on(I,e.next),V.on(I,e.complete)})),N=new w((e=>{V.on(M,e.next)})),Q=new w((e=>{V.on(k,e.next)})),W=({message:e,id:t,from:n})=>{if(!e)return;const s=U===n,o=document.createElement("div");o.textContent=e,D.appendChild(o),o.classList.add("j-message"),o.id=t,s?o.classList.add("owner-self"):o.classList.add("owner-other"),v().then((()=>o.classList.add("visible"))),o.scrollIntoView()},X=({id:e,updatedId:t})=>{const n=document.getElementById(e);n.classList.add("j-updated-id"),n.id=t},Y=()=>{V.emit(L,{userId:U})},Z=({message:e,id:t,textEl:n})=>{V.emit(E,{from:U,message:e,id:t}),n.value=""},ee=({userId:e})=>{if(A.has(e))return;const t=document.createElement("span");t.classList.add("user","u-float-right"),t.style.backgroundColor="#"+(16777215*Math.random()<<0).toString(16),_.appendChild(t),A.set(e,t)},te=({userId:e})=>{A.has(e)&&(A.get(e).remove(),A.delete(e))},ne=({userId:e})=>{A.has(e)&&A.get(e).classList.add("typing")},se=({userId:e})=>{A.has(e)&&A.get(e).classList.remove("typing")},oe=({target:e,id:t})=>{e.classList.add("large"),e.classList.contains("j-updated-id")?V.emit(k,{id:t}):v().then(z).then((()=>{e.classList.remove("large")}))},re=({id:e})=>{document.getElementById(e).classList.add("large")};document.addEventListener("DOMContentLoaded",(()=>{q=document.getElementById("title"),S=document.getElementById("send"),_=document.getElementById("activeUsers"),D=document.getElementById("messages"),R=document.getElementById("textInput");const e=w.fromEvent("keydown",R),t=w.fromEvent("click",S),n=w.fromEvent("click",D);v().then(O).then((()=>q.classList.add("u-fade"))),R.focus(),R.select(),F.subscribe({next:ee,complete:x}),G.subscribe({next:te,complete:x}),e.filter((e=>P(e.code))).map((e=>{const t=e.target;return{message:t.value.trim(),e:e,textEl:t,id:m()}})).subscribe({next:({message:e,id:t,textEl:n,e:s})=>{s.preventDefault(),Z({message:e,textEl:n,id:t}),W({message:e,id:t,from:U})},complete:x}),e.filter((e=>!P(e.code))).subscribe({next:Y,complete:x}),t.map((()=>({message:R.value.trim(),textEl:R}))).subscribe({next:({message:e,textEl:t})=>{const n=m();Z({message:e,id:n,textEl:t}),W({message:e,id:n,from:U})},complete:x}),H.filter((({from:e})=>e!==U)).subscribe({next:W,complete:x}),N.subscribe({next:X,complete:x}),n.filter((e=>{const t=e.target;return t&&t.classList.contains("j-message")&&t.classList.contains("owner-self")})).filter(((e,t=300)=>{let n,s=0;return()=>++s>=e?(s=0,window.clearTimeout(n),!0):(n&&window.clearTimeout(n),n=window.setTimeout((()=>{s=0}),t),!1)})(5)).map((e=>{const t=e.target;return{target:t,id:t.id}})).subscribe({next:oe,complete:x}),Q.subscribe({next:re,complete:x}),J.subscribe({next:ne,complete:x}),K.subscribe({next:se,complete:x})}))}();
//# sourceMappingURL=index.HASH_REF_7b9c3643e4543d898105d9473fa9768e.js.map
